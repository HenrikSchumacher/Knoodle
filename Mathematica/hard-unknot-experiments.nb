(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     27345,        631]
NotebookOptionsPosition[     23434,        579]
NotebookOutlinePosition[     23826,        595]
CellTagsIndexPosition[     23783,        592]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Exit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.9380914461735163`*^9, 3.938091447611404*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"5d043150-3d3a-419d-8ceb-ffbd0314c591"],

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<PM`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UninstallPackages", "[", 
   RowBox[{"$PM", ",", 
    RowBox[{"{", "\"\<KnotToolsLink\>\"", "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAllCache", "[", "$PM", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LoadPackages", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<Geometries\>\"", ",", "\"\<KnotToolsLink\>\""}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{3.9381769596596327`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"3a6a482f-fa8e-4bef-83be-a0f4aae32cf1"],

Cell[BoxData[
 RowBox[{"Exit", "[", "]"}]], "Input",ExpressionUUID->"eda3e33a-53c0-44dd-ba47-dc5b1314205e"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Most", " ", "of", " ", "the", " ", "time", " ", "you", " ", "do", " ", 
    "not", " ", "have", " ", "to", " ", 
    RowBox[{"recompile", ".", " ", "Then"}], " ", "load", " ", "the", " ", 
    "package", " ", "like", " ", "this", " ", "is", " ", 
    RowBox[{"faster", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Needs", "[", "\"\<PM`\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{"LoadPackages", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<Geometries\>\"", ",", "\"\<KnotToolsLink\>\""}], "}"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.938177866753852*^9, 3.9381779030430098`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"6aff141d-c6c4-4c4f-9c0e-5b794074090b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hardknotfiles", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ParentDirectory", "[", 
        RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", "\"\<data\>\"", 
       ",", "\"\<diagrams\>\"", ",", "\"\<hardunknots\>\"", ",", 
       "\"\<*.tsv\>\""}], "}"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.938176596561296*^9, 3.93817663201044*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"f12c64ef-d8b4-4f06-bc1c-e8cccb9ebdb7"],

Cell[BoxData[
 RowBox[{"PD", "=", 
  RowBox[{"PlanarDiagram", "[", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{"Echo", "[", 
      RowBox[{"hardknotfiles", "[", 
       RowBox[{"[", "20", "]"}], "]"}], "]"}], "]"}], ",", "0"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.93817649545019*^9, 3.9381765024996357`*^9}, {
   3.938176639417206*^9, 3.938176645132505*^9}, {3.938176741403699*^9, 
   3.938176748245771*^9}, {3.938177437152182*^9, 3.938177471679098*^9}, {
   3.9381775262001333`*^9, 3.938177536011396*^9}, 3.9381775787071257`*^9, 
   3.938177736023918*^9, {3.938178054724669*^9, 3.938178060435793*^9}, {
   3.938178133757716*^9, 3.938178135069722*^9}, 3.938178213446823*^9, {
   3.938178253917729*^9, 3.9381782606814127`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"1cf6834c-ce94-461b-88db-667c2def4dac"],

Cell[BoxData[
 RowBox[{"PD1", "=", 
  RowBox[{"SimplifyDiagram4", "[", "PD", "]"}]}]], "Input",
 CellChangeTimes->{{3.938176684779049*^9, 3.938176693976047*^9}, 
   3.938176763317499*^9, {3.938176883517754*^9, 3.9381769082708406`*^9}, 
   3.938177001844906*^9},
 CellLabel->"In[28]:=",ExpressionUUID->"e1be1780-e0f4-48ab-8db6-ded7bd62d2d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReginaHOMFLY", "[", 
   RowBox[{"PDCode", "[", "PD1", "]"}], "]"}], "[", 
  RowBox[{"L", ",", "M"}], "]"}]], "Input",
 CellChangeTimes->{3.938178107476192*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"c71bf8cb-5afe-4ea0-a60a-68e282ea3f5b"],

Cell[BoxData[
 RowBox[{"PDSnaPy", "=", 
  RowBox[{"SnapPySymplifyPickup", "[", 
   RowBox[{"PDCode", "[", "PD", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.938177972983679*^9, 3.938177988563983*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"c56dd467-479b-4b59-8914-3f681c3a0c0f"],

Cell[BoxData[
 RowBox[{"PDRegina", "=", 
  RowBox[{"ReginaSimplify", "[", 
   RowBox[{"PDCode", "[", "PD", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.938178000969768*^9, 3.938178017001403*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"7c4b1584-d9bb-4489-9239-b10d120dab27"],

Cell[BoxData[
 RowBox[{"PlotDiagram", "[", "PD", "]"}]], "Input",
 CellChangeTimes->{{3.938092435988318*^9, 3.938092441532565*^9}, {
  3.938092478797193*^9, 3.9380924832019053`*^9}, {3.9380925209789267`*^9, 
  3.938092522846479*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"432a1bae-fa8d-402f-9fbc-8983435d63eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BuildConstraintMatrix", "[", "PD_", "]"}], " ", ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#2", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], "}"}], "->", 
             RowBox[{"-", "1"}]}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#2", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "==", "1"}], ",", 
                  RowBox[{"Max", "[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "4"}], "}"}], "]"}], "]"}], "]"}], ",", 
                  "0"}], "]"}], "+", "1"}]}], "}"}], "->", 
             RowBox[{"+", "1"}]}]}], "}"}], "&"}], " ", ",", "PD"}], "]"}], 
       ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "PD", "]"}], ",", 
       RowBox[{"2", 
        RowBox[{"Length", "[", "PD", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[33]:=",ExpressionUUID->"6082684a-01cd-4594-831a-332fa1bd215b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BuildObjectiveFunction", "[", "PD_", "]"}], " ", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"#", ".", "#"}], ")"}], "&"}], "@", 
   RowBox[{"KirchhoffMatrix", "[", 
    RowBox[{"CycleGraph", "[", 
     RowBox[{"2", "*", 
      RowBox[{"Length", "[", "PD", "]"}]}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.937242720889142*^9, 3.937242751531775*^9}, {
  3.937243747417348*^9, 3.937243748970662*^9}, {3.9372462026490803`*^9, 
  3.93724627156639*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"9959d910-7837-4a3b-8579-0a3293dc114d"],

Cell[BoxData[
 RowBox[{"BuildObjectiveFunction", "[", 
  RowBox[{"PDCode", "[", "PD", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.937242755526783*^9, 3.937242758708439*^9}, {
  3.937243231650817*^9, 3.9372432365145617`*^9}, {3.9380932923092012`*^9, 
  3.9380932934330072`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"6635cdac-75bd-4cf3-be2e-61a1df505c0b"],

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"SuggestedLevels", " ", "=", " ", 
    RowBox[{"QuadraticOptimization", "[", 
     RowBox[{
      RowBox[{"BuildObjectiveFunction", "[", 
       RowBox[{"PDCode", "@", "PD"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"BuildConstraintMatrix", "[", 
         RowBox[{"PDCode", "@", "PD"}], "]"}], ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"-", "2"}], ",", 
          RowBox[{"Length", "[", 
           RowBox[{"PDCode", "@", "PD"}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
   ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.937242777228571*^9, 3.937242846151305*^9}, {
  3.9372428870318747`*^9, 3.937242898558545*^9}, {3.937243001447654*^9, 
  3.9372430247292128`*^9}, {3.9372432638833427`*^9, 3.937243333922037*^9}, {
  3.937243419985442*^9, 3.937243494262061*^9}, {3.937243894637019*^9, 
  3.937243897401422*^9}, {3.938093302227085*^9, 3.9380933183379517`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"06e07ef2-9b47-4a8b-bfdb-35cf45de1328"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", "SuggestedLevels", "]"}]], "Input",
 CellChangeTimes->{{3.937243495777293*^9, 3.9372435015940228`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"675dda5f-8cf2-457b-8f0f-06c6f10c8ac0"],

Cell["\<\
Here\[CloseCurlyQuote]s an experiment: what if we standardized the data by \
sort order to avoid different points being too close to each other.\
\>", "Text",
 CellChangeTimes->{{3.9381730771763372`*^9, 3.9381731121267147`*^9}, 
   3.938177591328414*^9},ExpressionUUID->"53d85d75-b89a-4397-b389-\
bfdcc60e8db7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DiscreteLevels", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Values", "@", " ", 
      RowBox[{"KeySort", "@", 
       RowBox[{"PositionIndex", "[", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#1", ",", 
               RowBox[{"#2", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "&"}], ",", 
            "SuggestedLevels"}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]}], ",", "1"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.938173114024168*^9, 3.938173261560273*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"7a725edf-62e0-48cb-b78c-2c3171759e45"],

Cell["\<\
Now we need to construct new geometry according to the Levels embedding. We\
\[CloseCurlyQuote]ll need the ArcLines associated to the diagram. The \
strategy is to add a vertical segment to the curve at the first corner (or \
failing that, in the middle of the arc) which connects the levels at the \
start and end of the arc. So ArcLine[i] should be the line corresponding to \
arc[i] in the PD code.\
\>", "Text",
 CellChangeTimes->{{3.9380938537113028`*^9, 3.938093884237088*^9}, {
  3.9381603669296207`*^9, 3.938160401590376*^9}, {3.938160478163927*^9, 
  3.93816060612957*^9}, {3.938162830920148*^9, 3.9381628310996943`*^9}, {
  3.938163170397683*^9, 3.938163237359633*^9}, {3.938165725586954*^9, 
  3.9381657613475857`*^9}, {3.938165813953108*^9, 
  3.93816581467209*^9}},ExpressionUUID->"2b843a95-8498-476c-a6ac-\
485be8ec550c"],

Cell["\<\
The value SuggestedLevels[[i]] is the height at the crossing at start of the \
(outgoing) arc i-1. \
\>", "Text",
 CellChangeTimes->{{3.9372415898611393`*^9, 3.937241657075429*^9}, {
   3.9372418203203287`*^9, 3.937241823989394*^9}, {3.938165839271955*^9, 
   3.9381659472866507`*^9}, 
   3.9381659794962463`*^9},ExpressionUUID->"05b894ba-24e1-4375-915c-\
7b3450420bbe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LevelsEmbedding", "[", 
   RowBox[{"PD_", ",", "L_"}], "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"augmentedArcLines", ",", "al", ",", "procL", ",", 
      RowBox[{"Lm", "=", "2"}], ",", "almost"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"al", " ", "=", " ", 
      RowBox[{"ArcLines", "[", 
       RowBox[{"Spherogram", "[", "PD", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"procL", " ", "=", " ", 
      RowBox[{"Association", "[", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"i", "->", 
            RowBox[{"Floor", "[", 
             RowBox[{"Lm", "*", 
              RowBox[{"L", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{
              RowBox[{"Length", "[", "L", "]"}], "-", "1"}]}], "}"}]}], "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], "->", 
           RowBox[{"Floor", "[", 
            RowBox[{"Lm", "*", 
             RowBox[{"Last", "[", "L", "]"}]}], "]"}]}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"augmentedArcLines", " ", "=", 
      RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "#", "]"}], "==", "2"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"Mean", "[", "#", "]"}], ",", 
              RowBox[{"Mean", "[", "#", "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"2", ";;"}], "]"}], "]"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], "&"}], " ", "@", " ", 
         RowBox[{"al", "[", "i", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Keys", "[", "al", "]"}], "]"}], "-", "1"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"almost", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"procL", "[", 
               RowBox[{"i", "-", "2"}], "]"}], "]"}], "/@", 
             RowBox[{"augmentedArcLines", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"procL", "[", 
               RowBox[{"i", "-", "1"}], "]"}], "]"}], "/@", 
             RowBox[{"augmentedArcLines", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"2", ";;"}]}], "]"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "al", "]"}]}], "}"}]}], " ", 
         "\[IndentingNewLine]", "]"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{
          RowBox[{"First", "[", "almost", "]"}], "-", 
          RowBox[{"Last", "[", "almost", "]"}]}], "]"}], ">", 
        RowBox[{"10.0", "^", 
         RowBox[{"(", 
          RowBox[{"-", "8"}], ")"}]}]}], ",", 
       RowBox[{"Append", "[", 
        RowBox[{"almost", ",", 
         RowBox[{"First", "[", "almost", "]"}]}], "]"}], ",", "almost"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.938093886851663*^9, 3.93809389778607*^9}, {
   3.9381606263079243`*^9, 3.938160626876809*^9}, {3.9381607548309298`*^9, 
   3.9381608020149517`*^9}, {3.938160857158292*^9, 3.9381608700540323`*^9}, {
   3.938160914487742*^9, 3.938160992700667*^9}, {3.938161026781672*^9, 
   3.938161028070484*^9}, {3.938161166551229*^9, 3.938161205165406*^9}, {
   3.938161236785791*^9, 3.938161240234812*^9}, {3.938161270322064*^9, 
   3.938161514750745*^9}, {3.9381615521749372`*^9, 3.938161774234152*^9}, {
   3.938161840638604*^9, 3.938161852923152*^9}, {3.9381618882675247`*^9, 
   3.938161947935471*^9}, {3.93816200232967*^9, 3.938162133274695*^9}, {
   3.9381622864864492`*^9, 3.938162299296843*^9}, {3.93816326253694*^9, 
   3.9381634598726473`*^9}, {3.9381635027686872`*^9, 3.938163552487233*^9}, {
   3.938166109587179*^9, 3.9381661166597223`*^9}, {3.938166183290738*^9, 
   3.938166184158408*^9}, 3.938173268136848*^9, {3.938175738494011*^9, 
   3.938175800110702*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"4386f827-cff5-47ab-b2e1-e3342f90adb9"],

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"Tube", "[", 
    RowBox[{
     RowBox[{"LevelsEmbedding", "[", 
      RowBox[{"PD", ",", "DiscreteLevels"}], "]"}], ",", "1.0"}], "]"}], ",", 
   
   RowBox[{"ViewPoint", "->", "Top"}], ",", 
   RowBox[{"ViewProjection", "->", "\"\<Orthographic\>\""}], ",", 
   RowBox[{"ViewVertical", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.938160974485587*^9, 3.9381610039765797`*^9}, {
  3.9381617975726557`*^9, 3.938161806575182*^9}, {3.9381621510617*^9, 
  3.938162172870409*^9}, {3.938166238334391*^9, 3.938166251411009*^9}, {
  3.938173280195787*^9, 3.938173284752159*^9}, {3.9381734993838043`*^9, 
  3.9381735012720957`*^9}, {3.9381735568949137`*^9, 3.9381735572854023`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"1f4cd151-d567-4ae9-b9ad-bc573c6919d0"],

Cell["\<\
Now we need to rotate this to get some new perspectives on everything. If we \
just choose left or right we\[CloseCurlyQuote]ll have a lot of \
\>", "Text",
 CellChangeTimes->{{3.93817355013834*^9, 3.938173598081052*^9}, 
   3.938178235434847*^9},ExpressionUUID->"7d7074c5-2722-4ae4-91c6-\
39dbc05dfc50"],

Cell[BoxData[
 RowBox[{"R", " ", "=", " ", 
  RowBox[{"RandomVariate", "[", 
   RowBox[{"CircularRealMatrixDistribution", "[", "3", "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9381736025856857`*^9, 3.938173619846191*^9}, {
  3.938173662763048*^9, 3.9381736900298643`*^9}, {3.938173721207905*^9, 
  3.938173726182517*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"1d9b9c1a-ebdf-43c0-b602-259aeb4049ad"],

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"Tube", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"LevelsEmbedding", "[", 
       RowBox[{"PD", ",", "DiscreteLevels"}], "]"}], ".", "R"}], ",", "1"}], 
    "]"}], ",", 
   RowBox[{"ViewPoint", "->", "Above"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.938173732696504*^9, 3.938173803341568*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"8552662b-96fc-4ff1-97e7-7d801e235da9"],

Cell[BoxData[
 RowBox[{"NewPD", " ", "=", " ", 
  RowBox[{"PlanarDiagram", "[", 
   RowBox[{
    RowBox[{"LevelsEmbedding", "[", 
     RowBox[{"PD", ",", "DiscreteLevels"}], "]"}], ".", "R"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.938173455559594*^9, 3.938173464411923*^9}, {
   3.9381739444961367`*^9, 3.938173958202916*^9}, 3.938176329989555*^9},
 CellLabel->"In[50]:=",ExpressionUUID->"83a120ee-f501-4625-b676-f616d516a063"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Should", " ", "be", " ", 
    RowBox[{"obsolete", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CompressDiagramInPlace", "[", "NewPD", "]"}]}]], "Input",
 CellChangeTimes->{{3.938174885550935*^9, 3.9381748910404463`*^9}, {
  3.9381763551740932`*^9, 3.938176361522325*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"38061e71-a671-4b17-8fea-d6c2082e5bf7"],

Cell[BoxData[
 RowBox[{"PlotDiagram", "[", "NewPD", "]"}]], "Input",
 CellChangeTimes->{{3.938173980840357*^9, 3.938174002723344*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"e8adaa29-5f22-4385-8b2e-8d906e8606f6"],

Cell[BoxData[
 RowBox[{"NewPDSimplified", " ", "=", " ", 
  RowBox[{"SimplifyDiagram4", "[", "NewPD", "]"}]}]], "Input",
 CellChangeTimes->{{3.938174044309279*^9, 3.938174065855825*^9}, {
   3.938174103435487*^9, 3.9381741077518187`*^9}, {3.9381741951798353`*^9, 
   3.9381742295865192`*^9}, {3.938174264311922*^9, 3.938174274605585*^9}, {
   3.938174329909747*^9, 3.938174354323536*^9}, 3.938174421768401*^9, {
   3.938174454500989*^9, 3.9381744798739977`*^9}, {3.938174541504736*^9, 
   3.938174570083455*^9}, {3.938174978303829*^9, 3.9381749925607853`*^9}, {
   3.9381763914062157`*^9, 3.938176420394754*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"6543df6c-d9ae-42a5-a385-49d29dce23a1"],

Cell[BoxData[
 RowBox[{"PlotDiagram", "[", "NewPDSimplified", "]"}]], "Input",
 CellChangeTimes->{{3.93817408777442*^9, 3.938174094131267*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"769f1571-343a-43dd-a27c-f0144f23edb3"],

Cell[BoxData[
 RowBox[{"ReginaHOMFLY", "[", 
  RowBox[{"PDCode", "[", "NewPDSimplified", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.938177623285605*^9, 3.938177630907096*^9}, {
  3.9381777011265793`*^9, 3.93817770287525*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"9324cfab-df5c-4154-8d63-3074d94c3e64"],

Cell[BoxData[
 RowBox[{"PDCode", "[", "NewPDSimplified", "]"}]], "Input",
 CellChangeTimes->{{3.938175093276907*^9, 3.938175099220251*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"ca2dd8e6-b343-49ec-b4e7-a9a849a006a8"],

Cell[BoxData[
 RowBox[{"SimplifyDiagram4", "[", "NewPDSimplified", "]"}]], "Input",
 CellChangeTimes->{{3.938175004284794*^9, 3.9381750146539593`*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"6e74d489-50aa-4923-b994-c5a61f12f36b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S", " ", "=", " ", 
   RowBox[{"Spherogram", "[", "PD", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.93809354798555*^9, 3.9380935556313953`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"275df4d7-92f2-4b1e-ac19-7e96d9bdfd88"],

Cell["Now we need to construct new geometry ", "Text",
 CellChangeTimes->{{3.938093813721773*^9, 
  3.93809385005238*^9}},ExpressionUUID->"814d716c-727e-4425-9034-\
6b3652c66b27"],

Cell[BoxData[
 RowBox[{"Values", "[", 
  RowBox[{"ArcLines", "[", "S", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.938160926384371*^9, 3.938160934855214*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"51979fff-8281-4632-a309-4ceaf1a51043"],

Cell[BoxData[
 RowBox[{"CrossingCoordinates", "[", "S", "]"}]], "Input",
 CellChangeTimes->{{3.938093360474234*^9, 3.9380933977594624`*^9}, {
  3.9380935006506243`*^9, 3.938093506539939*^9}, {3.938093563673129*^9, 
  3.938093565592289*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"ca4a12b7-206c-4a7d-8f69-7af7f2cd0546"],

Cell[BoxData[
 RowBox[{"Length", "[", "SuggestedLevels", "]"}]], "Input",
 CellChangeTimes->{{3.938093782226165*^9, 3.938093787686392*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"645bd50a-0340-4a81-b06a-68f85bc281fc"],

Cell[BoxData[
 RowBox[{"ArcLines", "[", "S", "]"}]], "Input",
 CellChangeTimes->{{3.938093682294119*^9, 3.9380936847513638`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"7f256b38-85bf-4261-b588-2d84b206c0f0"]
},
WindowSize->{1496, 905},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.1 for Mac OS X ARM (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ef4c530b-05f5-468b-a21f-88f80718c84b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 199, 3, 39, "Input",ExpressionUUID->"5d043150-3d3a-419d-8ceb-ffbd0314c591"],
Cell[756, 25, 595, 14, 112, "Input",ExpressionUUID->"3a6a482f-fa8e-4bef-83be-a0f4aae32cf1"],
Cell[1354, 41, 107, 1, 39, "Input",ExpressionUUID->"eda3e33a-53c0-44dd-ba47-dc5b1314205e"],
Cell[1464, 44, 768, 16, 112, "Input",ExpressionUUID->"6aff141d-c6c4-4c4f-9c0e-5b794074090b"],
Cell[2235, 62, 547, 12, 63, "Input",ExpressionUUID->"f12c64ef-d8b4-4f06-bc1c-e8cccb9ebdb7"],
Cell[2785, 76, 824, 16, 39, "Input",ExpressionUUID->"1cf6834c-ce94-461b-88db-667c2def4dac"],
Cell[3612, 94, 340, 6, 39, "Input",ExpressionUUID->"e1be1780-e0f4-48ab-8db6-ded7bd62d2d7"],
Cell[3955, 102, 273, 6, 39, "Input",ExpressionUUID->"c71bf8cb-5afe-4ea0-a60a-68e282ea3f5b"],
Cell[4231, 110, 282, 5, 39, "Input",ExpressionUUID->"c56dd467-479b-4b59-8914-3f681c3a0c0f"],
Cell[4516, 117, 277, 5, 39, "Input",ExpressionUUID->"7c4b1584-d9bb-4489-9239-b10d120dab27"],
Cell[4796, 124, 312, 5, 39, "Input",ExpressionUUID->"432a1bae-fa8d-402f-9fbc-8983435d63eb"],
Cell[5111, 131, 1897, 52, 112, "Input",ExpressionUUID->"6082684a-01cd-4594-831a-332fa1bd215b"],
Cell[7011, 185, 589, 14, 39, "Input",ExpressionUUID->"9959d910-7837-4a3b-8579-0a3293dc114d"],
Cell[7603, 201, 358, 6, 39, "Input",ExpressionUUID->"6635cdac-75bd-4cf3-be2e-61a1df505c0b"],
Cell[7964, 209, 1059, 23, 87, "Input",ExpressionUUID->"06e07ef2-9b47-4a8b-bfdb-35cf45de1328"],
Cell[9026, 234, 222, 3, 39, "Input",ExpressionUUID->"675dda5f-8cf2-457b-8f0f-06c6f10c8ac0"],
Cell[9251, 239, 321, 6, 50, "Text",ExpressionUUID->"53d85d75-b89a-4397-b389-bfdcc60e8db7"],
Cell[9575, 247, 830, 22, 39, "Input",ExpressionUUID->"7a725edf-62e0-48cb-b78c-2c3171759e45"],
Cell[10408, 271, 845, 14, 116, "Text",ExpressionUUID->"2b843a95-8498-476c-a6ac-485be8ec550c"],
Cell[11256, 287, 380, 8, 50, "Text",ExpressionUUID->"05b894ba-24e1-4375-915c-7b3450420bbe"],
Cell[11639, 297, 5516, 132, 453, "Input",ExpressionUUID->"4386f827-cff5-47ab-b2e1-e3342f90adb9"],
Cell[17158, 431, 897, 18, 63, "Input",ExpressionUUID->"1f4cd151-d567-4ae9-b9ad-bc573c6919d0"],
Cell[18058, 451, 314, 6, 50, "Text",ExpressionUUID->"7d7074c5-2722-4ae4-91c6-39dbc05dfc50"],
Cell[18375, 459, 408, 8, 39, "Input",ExpressionUUID->"1d9b9c1a-ebdf-43c0-b602-259aeb4049ad"],
Cell[18786, 469, 444, 11, 39, "Input",ExpressionUUID->"8552662b-96fc-4ff1-97e7-7d801e235da9"],
Cell[19233, 482, 434, 9, 39, "Input",ExpressionUUID->"83a120ee-f501-4625-b676-f616d516a063"],
Cell[19670, 493, 410, 8, 63, "Input",ExpressionUUID->"38061e71-a671-4b17-8fea-d6c2082e5bf7"],
Cell[20083, 503, 213, 3, 39, "Input",ExpressionUUID->"e8adaa29-5f22-4385-8b2e-8d906e8606f6"],
Cell[20299, 508, 691, 10, 39, "Input",ExpressionUUID->"6543df6c-d9ae-42a5-a385-49d29dce23a1"],
Cell[20993, 520, 222, 3, 39, "Input",ExpressionUUID->"769f1571-343a-43dd-a27c-f0144f23edb3"],
Cell[21218, 525, 311, 6, 39, "Input",ExpressionUUID->"9324cfab-df5c-4154-8d63-3074d94c3e64"],
Cell[21532, 533, 218, 3, 39, "Input",ExpressionUUID->"ca2dd8e6-b343-49ec-b4e7-a9a849a006a8"],
Cell[21753, 538, 234, 4, 39, "Input",ExpressionUUID->"6e74d489-50aa-4923-b994-c5a61f12f36b"],
Cell[21990, 544, 262, 5, 39, "Input",ExpressionUUID->"275df4d7-92f2-4b1e-ac19-7e96d9bdfd88"],
Cell[22255, 551, 179, 3, 50, "Text",ExpressionUUID->"814d716c-727e-4425-9034-6b3652c66b27"],
Cell[22437, 556, 239, 4, 39, "Input",ExpressionUUID->"51979fff-8281-4632-a309-4ceaf1a51043"],
Cell[22679, 562, 319, 5, 39, "Input",ExpressionUUID->"ca4a12b7-206c-4a7d-8f69-7af7f2cd0546"],
Cell[23001, 569, 218, 3, 39, "Input",ExpressionUUID->"645bd50a-0340-4a81-b06a-68f85bc281fc"],
Cell[23222, 574, 208, 3, 39, "Input",ExpressionUUID->"7f256b38-85bf-4261-b588-2d84b206c0f0"]
}
]
*)

